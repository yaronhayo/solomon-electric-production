---
// src/components/ui/Button.astro
interface Props {
  variant?: "primary" | "secondary" | "outline" | "icon";
  size?: "lg" | "md" | "sm";
  href?: string;
  class?: string;
  type?: "button" | "submit" | "reset";
  id?: string;
  [x: string]: any;
}

const {
  variant = "primary",
  size = "md",
  href,
  class: className = "",
  type = "button",
  id,
  ...rest
} = Astro.props;

// Base styles for all buttons
const baseStyles =
  "inline-flex items-center justify-center font-secondary font-bold uppercase transition-all duration-[var(--transition-base)] ease-[var(--ease-out)] group relative overflow-hidden magnetic-cta focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-accent)] focus-visible:ring-offset-2 active:scale-[0.97] active:brightness-90";
const shadowStyle = "hover:shadow-[var(--shadow-accent-md)]";

const sizes = {
  lg: "h-[56px] px-8 text-[length:var(--text-body)]",
  md: "h-[48px] px-6 text-[length:var(--text-nav)]",
  sm: "h-[40px] px-5 text-[length:var(--text-label)]",
};

// Variant styles matching Figma (Colors & Clip Path only)
const variants = {
  primary: `
    bg-gradient-to-r from-accent to-[var(--color-accent-dark)] text-[var(--color-primary-dark)]
    hover:from-primary hover:to-[var(--color-primary-dark)] hover:text-white
    leading-[1.5] shimmer-authority
    [clip-path:polygon(12px_0%,100%_0%,calc(100%_-_12px)_100%,0%_100%)]
  `,
  secondary: `
    bg-primary text-white border-2 border-accent/30
    hover:bg-accent hover:text-primary hover:border-accent
    leading-[1.5]
    [clip-path:polygon(12px_0%,100%_0%,calc(100%_-_12px)_100%,0%_100%)]
  `,
  outline: `
    bg-transparent text-primary border-2 border-primary
    hover:bg-primary hover:text-white
    leading-[1.5]
    [clip-path:polygon(12px_0%,100%_0%,calc(100%_-_12px)_100%,0%_100%)]
  `,
  icon: `
    bg-accent text-[var(--color-primary-dark)]
    hover:bg-primary hover:text-white
    !px-0 w-[44px] h-[44px]
    text-[length:var(--text-body)]
    rounded-[var(--radius-full)]
    shimmer-authority
  `,
};

// Handle old "mobile" variant mapping if necessary, or just rely on manual updates.
// For now, if someone passes "mobile" as variant (which was removed from types but might be in code),
// it will fall back to undefined in variants object.
// We should check usages of variant="mobile" and update them to size="sm".

const styles = [
  baseStyles,
  shadowStyle,
  variants[variant] || variants.primary,
  variant !== "icon" ? sizes[size] : "",
  className,
]
  .join(" ")
  .split(/\s+/)
  .filter((c, i, a) => c && a.indexOf(c) === i)
  .join(" ");

// Element Logic: render <a> if href exists, otherwise <button>
const Element = href ? "a" : "button";
---

<!-- Custom slant effects using pseudo-elements or just simplified CSS for now --><!-- The design shows "Rectangle 12" and "Rectangle 14" creating a slanted look or borders. 
     For now, we will stick to a clean rectangular button with the requested colors/fonts 
     unless we implement the complex multi-part logic. 
     The spec shows strict "auto layout" with rectangles. 
     Standard implementation: Simple standardized button first.
-->
<Element
  href={href}
  type={!href ? type : undefined}
  class={styles}
  id={id}
  {...rest}><slot /></Element
>
